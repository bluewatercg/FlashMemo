好的，收到您的需求！

作为您的产品经理 nimbus，我将为您详细撰写闪记卡App的核心功能——**“卡片创建与管理 (Card Creation & Management)”** 的产品需求文档（PRD）。这份文档将足够清晰详尽，可以直接交付给您的UI/UX设计师和开发团队。

---

# 闪记卡App - 产品需求文档 (PRD)

*   **模块名：** 卡片创建与管理 (Card Creation & Management)
*   **作者：** nimbus
*   **版本：** 1.0
*   **日期：** 2023年10月27日
*   **描述：** 本文档详细阐述了闪记卡App内容创建的核心功能，旨在确保用户能够轻松、高效、灵活地创建和组织他们的学习资料。

---

*   **功能名：** 卡片创建与管理 (Card Creation & Management)
*   **需求描述：**
    为用户提供一个强大且易于使用的卡片创建和组织系统。它是整个App的基石，用户需要通过此功能将知识点转化为结构化的、可复习的卡片。该功能需支持文本、富媒体内容的输入，并提供卡组和标签两种维度对卡片进行系统化管理，以适应不同学科和个人学习习惯的需求。
*   **概述：**
    本产品是一款基于“主动回忆”和“间隔重复”科学学习理论的智能闪记卡App。其核心目标是通过高效的卡片创建、智能的复习调度和详尽的学习追踪，帮助用户将短期记忆转化为长期知识，从而提升学习效率和效果。
*   **相关页面设计：**
    *   **1. 卡组列表页 (Deck List Page):**
        *   **布局:** 以列表或网格形式展示用户所有的一级卡组和文件夹。
        *   **元素:**
            *   每个卡组项显示：卡组名称、待学习新卡数、待复习卡片数、卡片总数。
            *   文件夹项显示：文件夹名称、包含的卡组数量。
            *   全局操作按钮：页面顶部或底部悬浮一个“+”按钮，点击后可选择“创建卡组”或“创建文件夹”。
        *   **交互:**
            *   点击卡组进入卡组详情页或直接开始学习。
            *   点击文件夹展开，显示其包含的卡组。
            *   支持对卡组/文件夹进行长按/右键操作，弹出菜单（重命名、移动、删除、导出）。

    *   **2. 卡片编辑器 (Card Editor - 核心页面):**
        *   **布局:**
            *   顶部：选择所属卡组（下拉菜单，支持搜索和即时创建新卡组）、选择卡片模板（当前版本仅“基础型”）。
            *   中部核心区：分为“正面 (Front)”和“背面 (Back)”两个输入区域。
            *   每个输入区域都是一个富文本编辑器，上方配有工具栏。
            *   底部：标签输入区、操作按钮。
        *   **元素与工具栏:**
            *   **富文本工具栏:** 加粗(B)、斜体(I)、下划线(U)、文字颜色、背景高亮、项目符号列表、数字列表、引用块。
            *   **媒体插入按钮:** “插入图片”（支持本地上传/URL/粘贴）、“插入音频”（支持本地上传/录制）、“插入视频”（支持本地上传/嵌入URL）。
            *   **标签输入框:** 支持输入多个标签，已存在的标签可自动补全，输入新标签后按回车确认。
        *   **操作按钮:** “保存”、“保存并再添加一张”、“取消”。

    *   **3. 卡片浏览器 (Card Browser/Manager):**
        *   **布局:**
            *   左侧栏：显示卡组和标签的树状结构，供用户筛选。
            *   右侧主区域：以表格形式显示筛选出的卡片列表。
        *   **列表元素:** 表格每行代表一张卡片，列包括：正面内容预览、背面内容预览、所属卡组、标签、创建日期、修改日期。
        *   **交互:**
            *   支持对卡片进行批量操作（如批量修改标签、移动到其他卡组、删除）。
            *   点击任意一张卡片，可直接在弹窗或新页面中打开卡片编辑器进行修改。

*   **用户旅程 (User Journey):**
    *   **旅程一：创建第一个卡组和第一张卡片**
        1.  **启动App:** 新用户进入App，看到卡组列表页是空的，只有一个引导性的“创建卡组”按钮。
        2.  **创建卡组:** 点击按钮，输入卡组名称（如“雅思核心词汇500”），点击确认。
        3.  **添加卡片:** 页面跳转到新创建的空卡组内，提示用户“添加第一张卡片”。用户点击“添加卡片”，进入卡片编辑器。
        4.  **编辑卡片:** 在“正面”输入“abandon”，在“背面”输入“v. 放弃，抛弃”。用户觉得“放弃”是核心意思，于是选中“放弃”并使用工具栏将其**加粗**并**标红**。
        5.  **添加标签:** 在标签区域输入“动词”和“高频词”，创建了两个标签。
        6.  **保存:** 点击“保存并再添加一张”，当前卡片被保存，编辑器被清空，用户可以继续添加下一张卡片。

    *   **旅程二：整理已有卡片**
        1.  **进入浏览器:** 用户学习了一段时间后，觉得需要整理卡片。他从某个卡组页面进入“卡片浏览器”。
        2.  **筛选卡片:** 在左侧栏点击“雅思核心词汇500”卡组，然后点击“动词”标签。右侧列表只显示该卡组下所有带“动词”标签的卡片。
        3.  **批量修改:** 用户发现有几张卡片忘记打“高频词”标签了。他勾选这几张卡片，点击顶部的“批量修改标签”按钮，添加了“高频词”标签。
        4.  **移动卡片:** 用户决定创建一个新的子卡组叫“第一单元动词”。他批量选中相关卡片，点击“移动”，在弹出的卡组选择器中选择了新卡组，完成移动。

*   **用户故事 (User Stories):**
    *   **作为一名语言学习者，** 我希望能在卡片的正面放单词，背面放释义和例句，并且能为单词配上发音音频，这样我复习时就能音形义结合，记忆更深刻。
    *   **作为一名医学生，** 我希望能在卡片正面放一张解剖图，背面放对应的器官名称和功能描述，并且可以对文字进行加粗和高亮，方便我标记重点。
    *   **作为一名备考的学生，** 我希望可以为我的所有卡片按照章节（如“第一章”、“第二章”）和难度（如“简单”、“中等”、“困难”）打上标签，这样在考前我就可以只复习“困难”的或者特定章节的卡片。
    *   **作为一名知识整理爱好者，** 我希望可以创建文件夹来组织我的卡组，比如创建一个“编程”文件夹，里面再放“Java”、“Python”、“算法”等不同的卡组，让我的知识体系一目了然。

*   **实现逻辑 (Implementation Logic):**
    *   **1.数据模型设计:**
        *   `Decks` 表: `deck_id` (主键), `name`, `description`, `parent_id` (用于实现文件夹嵌套), `created_at`.
        *   `Cards` 表: `card_id` (主键), `deck_id` (外键), `template_type` (如 'basic'), `created_at`, `updated_at`.
        *   `Card_Content` 表: `content_id` (主键), `card_id` (外键), `side` ('front'或'back'), `content` (存储HTML格式的富文本内容).
        *   `Tags` 表: `tag_id` (主KEY), `name`.
        *   `Card_Tags` 关联表: `card_id`, `tag_id`.
    *   **2.富文本编辑器:**
        *   前端应采用成熟的开源富文本编辑器库（如 Tiptap, Quill.js, Slate.js）。
        *   编辑器的输出应为标准的HTML，后端直接存储此HTML字符串。
        *   渲染卡片时，直接将存储的HTML渲染到页面上。
    *   **3.媒体文件处理:**
        *   用户上传的图片、音视频文件应存储在云对象存储服务（如AWS S3, 阿里云OSS）中。
        *   数据库中只存储文件的URL地址。
        *   富文本内容中的媒体标签（`<img>`, `<audio>`, `<video>`）的 `src` 属性指向云存储的URL。
        *   需考虑文件上传的进度显示、大小限制和格式校验。
    *   **4.标签系统:**
        *   标签输入框应支持自动补全（autocomplete），查询已存在的标签。
        *   后端在保存卡片时，处理标签逻辑：解析用户输入的标签，与 `Tags` 表对比，对新标签进行插入，最后更新 `Card_Tags` 关联表。

*   **功能细节描述 (Functional Details):**
    *   **卡组与文件夹:**
        *   卡组和文件夹名称在同一层级下必须唯一。
        *   支持拖拽方式调整卡组和文件夹的顺序及层级关系。
        *   删除文件夹时，应提供选项：“仅删除文件夹（内部卡组移至上层）”或“删除文件夹及其包含的所有卡组和卡片”（危险操作，需二次确认）。
        *   删除卡组时，需明确提示将永久删除其下的所有卡片，并要求用户输入卡组名称以确认。
    *   **卡片编辑器:**
        *   编辑器应支持粘贴操作，能自动识别并处理从网页或Word中复制的带格式文本和图片。
        *   音频支持即时录制功能，录制完成后直接上传。
        *   “保存并再添加一张”功能应保持当前选择的卡组和已输入的标签，方便用户连续添加同类卡片。
    *   **富媒体:**
        *   图片支持常见格式（JPG, PNG, GIF），并进行适当压缩以节省存储和加载时间。
        *   音频支持常见格式（MP3, WAV）。
        *   视频播放建议使用嵌入式播放器，而不是自动播放。
    *   **标签:**
        *   标签名不允许包含特殊字符如逗号、分号。
        *   在卡片浏览器中，筛选逻辑应支持“与”（AND，同时包含多个标签）和“或”（OR，包含任一标签）的切换。
